<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">

<!-- Viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Offre Spéciale</title>

<!-- Preconnect fontes -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Fonte -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Preload imagens principais (LCP) -->
<link rel="preload" as="image" href="{{DESKTOP_PRINT}}">
<link rel="preload" as="image" href="{{MOBILE_PRINT}}" media="(max-width: 768px)">

<style>
:root{
  --desktop-bg-image:url('{{DESKTOP_PRINT}}');
  --mobile-bg-image:url('{{MOBILE_PRINT}}');
}

*{margin:0;padding:0;box-sizing:border-box}

html,body{
  height:100%;
  overflow:hidden;
  font-family:Poppins,sans-serif;
}

/* Background */
.background-container{
  position:fixed;
  inset:0;
  background-image:var(--desktop-bg-image);
  background-size:cover;
  background-position:center;
  filter:brightness(.8);
  z-index:-1;
  will-change:transform;
}

@media(max-width:768px){
  .background-container{
    background-image:var(--mobile-bg-image);
  }
}

/* Overlay sem flash */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition:opacity .35s ease;
}

.overlay.show{
  opacity:1;
  pointer-events:auto;
}

/* Popup estável (CLS) */
.popup{
  background:#fff;
  border-radius:16px;
  padding:25px;
  max-width:320px;
  width:90%;
  text-align:center;
  transform:scale(.9);
  transition:transform .35s ease;
  will-change:transform;
}

.overlay.show .popup{
  transform:scale(1);
}

/* Pricing */
.pricing{
  background:#f8f9fa;
  padding:20px;
  border-radius:12px;
  margin:20px 0;
}

.line{
  display:flex;
  justify-content:space-between;
  margin-bottom:10px;
}

.old{
  text-decoration:line-through;
  color:#e74c3c;
}

.new{
  font-size:22px;
  font-weight:700;
  color:#27ae60;
}

/* Timer */
.timer{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:20px 0;
}

.unit{
  background:#f8f9fa;
  padding:10px;
  border-radius:8px;
  min-width:60px;
}

.unit span{
  display:block;
  font-weight:700;
}

/* Bouton */
button{
  width:100%;
  padding:15px;
  border:none;
  border-radius:50px;
  background:#ff5e3a;
  color:#fff;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="background-container"></div>

<div class="overlay" id="overlay">
  <div class="popup">
    <h2>{{PLAN_TITLE}}</h2>

    <div class="pricing">
      <div class="line">
        <span>Original:</span>
        <span class="old">$<span id="anchor"></span></span>
      </div>
      <div class="line">
        <span>Votre prix:</span>
        <span class="new">$<span id="price"></span></span>
      </div>
      <div class="line">
        <span>Par unité:</span>
        <span>$<span id="unit"></span></span>
      </div>
    </div>

    <div class="timer">
      <div class="unit"><span id="m">00</span>Min</div>
      <div class="unit"><span id="s">00</span>Sec</div>
    </div>

    <button id="cta">Obtenir la Réduction</button>
  </div>
</div>

<script>
const AFFILIATE_LINK = "{{AFFILIATE_LINK}}";
const ANCHOR_PRICE = {{ANCHOR_PRICE}};
const YOUR_PRICE = {{YOUR_PRICE}};
let time = {{OFFER_MINUTES}} * 60;
let clicked = false;

document.getElementById('anchor').textContent = ANCHOR_PRICE;
document.getElementById('price').textContent = YOUR_PRICE;
document.getElementById('unit').textContent = (YOUR_PRICE / 6).toFixed(2);

const m = document.getElementById('m');
const s = document.getElementById('s');
const btn = document.getElementById('cta');

setInterval(()=>{
  if(time<=0){
    btn.textContent='Expiré';
    btn.style.opacity=.5;
    btn.onclick=null;
    return;
  }
  m.textContent=String(Math.floor(time/60)).padStart(2,'0');
  s.textContent=String(time%60).padStart(2,'0');
  time--;
},1000);

btn.onclick=()=>{
  if(clicked) return;
  clicked=true;
  location.href=AFFILIATE_LINK;
};

/* Exibe após load completo (sem flicker) */
window.onload=()=>{
  document.getElementById('overlay').classList.add('show');
};
</script>

</body>
</html>
